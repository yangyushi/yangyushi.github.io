<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>python module struct</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/styles/rainbow.css">
    <script src="/assets/js/toc.js"></script>
    <script src="/assets/js/highlight.pack.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>

    <script type="text/javascript" async
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

    </head>

  <body>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <nav>
    <ul>
        
        <li>
        <a href=/
            
        >Home</a>
        </li>
        
        <li>
        <a href=/code.html
            
        >Code</a>
        </li>
        
        <li>
        <a href=/science.html
            
        >Science</a>
        </li>
        
        <li>
        <a href=/about.html
            
        >About</a>
        </li>
        
    </ul>
</nav>


    <div class="main_box">
        <div class="column left" id="side_bar">
    09 Dec 2017
</div>

<div class="column right">
    <ul id="markdown-toc">
  <li><a href="#pack" id="markdown-toc-pack">pack</a></li>
  <li><a href="#calcsize" id="markdown-toc-calcsize">calcsize</a></li>
  <li><a href="#unpack" id="markdown-toc-unpack">unpack</a></li>
</ul>

<p>the struct module in python allow us to work with binary data.</p>

<h2 id="pack">pack</h2>

<blockquote>
  <p><code class="highlighter-rouge">struct.pack(fmt, v1, v2, ...)</code>
Return a bytes object containing the values v1, v2, … packed according to the format string fmt. The arguments must match the values required by the format exactly.</p>
</blockquote>

<p><code class="highlighter-rouge">pack</code> 方法可以把数值按照格式打包成二进制数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">packed_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">'iif'</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">)</span> <span class="c1"># iif → int, int, float
</span><span class="k">print</span><span class="p">(</span><span class="n">packed_data</span><span class="p">)</span>
<span class="n">b</span><span class="s">'</span><span class="se">\x06\x00\x00\x00\x13\x00\x00\x00</span><span class="s">ff</span><span class="se">\x96</span><span class="s">@'</span>
</code></pre></div></div>

<h2 id="calcsize">calcsize</h2>

<blockquote>
  <p><code class="highlighter-rouge">struct.calcsize(fmt)</code>
Return the size of the struct (and hence of the bytes object produced by pack(fmt, …)) corresponding to the format string fmt.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="s">'i'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="s">'f'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="s">'cif'</span><span class="p">))</span>

<span class="mi">1</span>
<span class="mi">4</span>
<span class="mi">4</span>
<span class="mi">12</span>
</code></pre></div></div>

<h2 id="unpack">unpack</h2>

<blockquote>
  <p><code class="highlighter-rouge">struct.unpack(fmt, buffer)</code>
Unpack from the buffer buffer (presumably packed by pack(fmt, …)) according to the format string fmt. The result is a tuple even if it contains exactly one item. The buffer’s size in bytes must match the size required by the format, as reflected by calcsize().</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">'iif'</span><span class="p">,</span> <span class="n">b</span><span class="s">'</span><span class="se">\x06\x00\x00\x00\x13\x00\x00\x00</span><span class="s">ff</span><span class="se">\x96</span><span class="s">@'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mf">4.699999809265137</span><span class="p">)</span>
</code></pre></div></div>


</div>

    </div>

  </body>

</html>

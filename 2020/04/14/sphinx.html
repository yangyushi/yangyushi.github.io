<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Sphinx</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/styles/github-gist.css">
    <script src="/assets/js/toc.js"></script>
    <script src="/assets/js/highlight.pack.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>

    <script type="text/javascript" id="MathJax-script" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
      >
    </script>
    
    </head>

  <body>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <nav>
    <ul>
        
        <li>
        <a href=/
            
        >
            My Notebook
        </a>
        </li>
        
        <li>
        <a href=/about.html
            
        >
            About Me
        </a>
        </li>
        
    </ul>
</nav>


    <div class="main">
        <div id="side_bar">
    14 Apr 2020
</div>

<div class="post center">
    &lt;!doctype html&gt;
<html>
<head>
<meta charset="utf-8" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/lib/index.min.js" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath@0.6.5/css/texmath.css" />
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css" />

</head>
<body class="markdown-body">

<ul>
<li data-line="6" class="code-line">TOC
{:toc}</li>
</ul>
<hr />
<p data-line="11" class="code-line">我最近使用 <code>Sphinx</code> 把我的<a href="https://github.com/yangyushi/FishPy" data-href="https://github.com/yangyushi/FishPy">博士期间的代码</a>的文档构建了出来。我十分喜欢<a href="https://yangyushi.github.io/FishPy/" data-href="https://yangyushi.github.io/FishPy/">得到的结果</a>。使用 <code>Sphinx</code> 构建文档的过程同 <code>Jekyll</code> 的使用类似，都是从文本中读取信息，然后在渲染到 HTML 网页中。</p>
<hr />
<h2 id="%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B" data-line="15" class="code-line">使用流程</h2>
<ol>
<li data-line="17" class="code-line">无论使用什么语言，好好写 <code>docstring</code></li>
<li data-line="18" class="code-line">用 <code>sphinx-quickstart</code> 生成一堆东西</li>
<li data-line="19" class="code-line">修改 <code>conf.py</code></li>
<li data-line="20" class="code-line">使用 <code>sphinx-apidoc 模块地址 -o rst导出地址</code> 生成每个 package 的 rst 文档</li>
<li data-line="21" class="code-line">把 <code>modules</code> 加入到 <code>index.rst</code></li>
</ol>
<h2 id="%E6%9C%89%E7%94%A8%E7%9A%84%E6%89%A9%E5%B1%95" data-line="23" class="code-line">有用的扩展</h2>
<p data-line="25" class="code-line">在 Sphinx 中，我们需要 增加一些 扩展 Extension 才能让 Sphinx 变得有用。我个人使用的 Extension 如下，</p>
<pre><code data-line="27" class="code-line language-python"><div> extensions = [
    <span class="hljs-string">'sphinx.ext.autodoc'</span>,
    <span class="hljs-string">'sphinx.ext.napoleon'</span>,
    <span class="hljs-string">'sphinx.ext.intersphinx'</span>,
    <span class="hljs-string">'sphinx.ext.mathjax'</span>,
]
</div></code></pre>
<p data-line="36" class="code-line">其中，每个扩展的作用 分别是</p>
<ol>
<li data-line="38" class="code-line"><code>autodoc</code>: 配合 <code>sphinx-apidoc</code> 自动生成所有 package 下「每个模块」的 文档。</li>
<li data-line="39" class="code-line"><code>napoleon</code>: 让 Sphinx 能够 理解 Google 风格的 docstring。</li>
<li data-line="40" class="code-line"><code>intersphinx</code>: 让 Sphinx 能够自动给文档里的 类、函数 添加链接</li>
<li data-line="41" class="code-line"><code>mathjax</code>: 配合 <code>:math:</code> 和 <code>.. math::</code> 在文档里渲染 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LaTeX</mtext></mrow><annotation encoding="application/x-tex">\LaTeX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.89883em;vertical-align:-0.2155em;"></span><span class="mord text"><span class="mord textrm">L</span><span class="mspace" style="margin-right:-0.36em;"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.68333em;"><span style="top:-2.904999em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord"><span class="mord textrm mtight sizing reset-size6 size3">A</span></span></span></span></span></span><span class="mspace" style="margin-right:-0.15em;"></span><span class="mord text"><span class="mord textrm">T</span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.46782999999999997em;"><span style="top:-2.7845em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord textrm">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2155em;"><span></span></span></span></span><span class="mspace" style="margin-right:-0.125em;"></span><span class="mord textrm">X</span></span></span></span></span></span> 公式</li>
</ol>
<h2 id="%E5%9C%A8%E7%BD%91%E9%A1%B5%E4%B8%AD%E6%B8%B2%E6%9F%93%E4%BB%A3%E7%A0%81%E5%9D%97" data-line="43" class="code-line">在网页中渲染代码块</h2>
<pre><code data-line="45" class="code-line"><code><div>.. code-block::

    your code
</div></code></code></pre>
<h2 id="%E5%9C%A8%E7%BD%91%E9%A1%B5%E4%B8%AD%E6%B8%B2%E6%9F%93%E5%85%AC%E5%BC%8F" data-line="51" class="code-line">在网页中渲染公式</h2>
<p data-line="53" class="code-line">把这个 2020 年还 work 的 CDN 添加到 <code>conf.py</code></p>
<pre><code data-line="55" class="code-line language-py"><div>mathjax_path = <span class="hljs-string">"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"</span>
</div></code></pre>
<p data-line="59" class="code-line">使用下面代码渲染 单独的 公式</p>
<pre><code data-line="61" class="code-line"><code><div>.. math::

    \LaTeX code
</div></code></code></pre>
<p data-line="67" class="code-line">使用 <code>:math:``latex</code></p>
<h2 id="%E5%8A%A0%E5%85%A5%E9%93%BE%E6%8E%A5%E5%88%B0-python-%E6%96%87%E6%A1%A3" data-line="69" class="code-line">加入链接到 Python 文档</h2>
<p data-line="71" class="code-line">普通情况下，我们用 sphinx 写 python 的 docstring 时，我们写出下面的代码</p>
<pre><code data-line="73" class="code-line language-py"><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(a)</span>:</span>
    <span class="hljs-string">"""
    Foo
    
    Args:
        a (int): ...
    """</span>
    ...
</div></code></pre>
<p data-line="84" class="code-line">这个时候，类型 <code>int</code> 能够配合 <code>intersphinx</code> 产生一个链接到 python 文档的链接。但是字体是普通的斜体。如果我们写出下面的代码</p>
<pre><code data-line="86" class="code-line language-py"><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(a)</span>:</span>
    <span class="hljs-string">"""
    Foo
    
    Args:
        a (:obj: `int`): ...
    """</span>
    ...
</div></code></pre>
<p data-line="97" class="code-line">生成的链接就会是非衬线体，好看一点。</p>
<p data-line="100" class="code-line">... 未完待续</p>

</body></html>
</div>


    </div>

  </body>

</html>
